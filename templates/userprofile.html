{%  extends 'header.html'  %}

{% load static %}
{% block content  %}
<style>
  .tabs__content {
  display: none;
}

.tabs__content.active-tab {
  display: block;
}

  /* General container for the address section */
.tab__content {
  background-color: #f9f9f9;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  margin-top: 20px;
}

.tab__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 1.5rem;
  margin-bottom: 20px;
  color: #333;
}

.add-address-btn {
  padding: 10px 20px;
  background-color: #4CAF50;
  color: white;
  text-decoration: none;
  border-radius: 5px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.add-address-btn:hover {
  background-color: #45a049;
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
}

/* Styling for the individual address block */
.tab__body {
  background-color: #fff;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.address {
  font-size: 1rem;
  line-height: 1.5;
}

.address p {
  margin: 5px 0;
}

.address strong {
  font-weight: bold;
}

.address .edit-address-btn,
.address .delete-address-btn {
  margin-top: 10px;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
  text-align: center;
}

/* Edit button styling */
.edit-address-btn {
  background-color: #ffa500;
  color: white;
  text-decoration: none;
  border: none;
}

.edit-address-btn:hover {
  background-color: #e68a00;
}

/* Delete button styling */
.delete-address-btn {
  background-color: #f44336;
  color: white;
  border: none;
}

.delete-address-btn:hover {
  background-color: #d32f2f;
}

/* Responsiveness for smaller screens */
@media (max-width: 768px) {
  .tab__header {
    font-size: 1.2rem;
  }

  .tab__body {
    padding: 10px;
  }

  .add-address-btn {
    font-size: 0.9rem;
    padding: 8px 15px;
  }

  .edit-address-btn, .delete-address-btn {
    font-size: 0.9rem;
    padding: 6px 12px;
  }
}

  /* General Styles */
body {
  font-family: Arial, sans-serif;
  background-color: #f4f6f9;
  color: #333;
  margin: 0;
}

.tab__header {
  font-size: 1.5rem;
  font-weight: bold;
  margin-bottom: 20px;
  text-align: center;
  color: #444;
}

.tab__body {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Table Styles */
.placed__order-table {
  width: 100%;
  border-collapse: collapse;
  margin: 20px 0;
}

.placed__order-table th, 
.placed__order-table td {
  padding: 15px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

.placed__order-table th {
  background-color: #f4f4f4;
  font-weight: bold;
  text-transform: uppercase;
  font-size: 0.85rem;
}

.placed__order-table tr:hover {
  background-color: #f9f9f9;
}

.placed__order-table td {
  font-size: 0.9rem;
}

/* Status Styling */
.status {
  font-weight: bold;
  text-transform: capitalize;
}

.status.pending {
  color: orange;
}

.status.canceled {
  color: red;
}

.status.delivered {
  color: green;
}

.status.default {
  color: black;
}

/* Buttons */
.btn {
  display: inline-block;
  padding: 8px 12px;
  font-size: 0.9rem;
  text-decoration: none;
  color: #fff;
  border-radius: 4px;
  transition: background-color 0.3s ease;
}

.view__order {
  background-color: #4e73df;
}

.view__order:hover {
  background-color: #224abe;
}

/* Empty Orders */
.no-orders {
  text-align: center;
  padding: 20px;
}

.no-orders h2 {
  font-size: 1.2rem;
  color: #555;
}

</style>
<style>
  /* Global Styles */
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background-color: #f4f6f9;
  color: #333;
}

.container {
  width: 90%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* Header */
.dashboard-header {
  background: linear-gradient(90deg, #4e73df, #224abe);
  color: #fff;
  padding: 20px 0;
  text-align: center;
}

.dashboard-header h1 {
  margin: 0;
  font-size: 2rem;
}

/* Profile Card */
.profile-card {
  background: #fff;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 20px;
}

.profile-header {
  background: linear-gradient(90deg, hsl(176, 88%, 27%), hsl(176, 88%, 27%));
  color: #fff;
  text-align: center;
  padding: 20px;
}

.profile-header .profile-icon {
  font-size: 3rem;
  margin-bottom: 10px;
}

.profile-header h2 {
  margin: 0;
  font-size: 1.5rem;
}

.profile-header .subtitle {
  font-size: 0.9rem;
  opacity: 0.8;
}

.profile-details {
  padding: 20px;
}

.profile-details ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.profile-details li {
  display: flex;
  justify-content: space-between;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}

.profile-details li:last-child {
  border-bottom: none;
}

.profile-actions {
  padding: 20px;
  text-align: center;
  border-top: 1px solid #eee;
}

.profile-actions .btn {
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  font-size: 1rem;
  cursor: pointer;
  margin: 0 5px;
}

.profile-actions .btn-primary {
  background: #4e73df;
  color: #fff;
}

.profile-actions .btn-primary:hover {
  background:  hsl(176, 88%, 27%);
}

.profile-actions .btn-danger {
  background: #e74a3b;
  color: #fff;
}

.profile-actions .btn-danger:hover {
  background: #c0392b;
}

</style>
<style>
  .form__field {
  display: flex;
  gap: 10px; /* Space between the inputs */
  margin-bottom: 15px; /* Spacing between fields */
}

.form__input {
  flex: 1; /* Make inputs flexible */
  padding: 10px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 5px;
}

.form__input--half {
  width: calc(50% - 5px); /* Half-width inputs with space in-between */
}

.form__btn {
  text-align: center;
}
/* Modal Styles */
/* Modal Background */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

/* Modal Content */
.modal-content {
    background: #fff;
    width: 90%;
    max-width: 500px;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

/* Header */
.modal-header {
    background:  hsl(176, 88%, 27%);
    color: #fff;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h2 {
    margin: 0;
    font-size: 18px;
}

.modal-header .close {
    color: #fff;
    font-size: 20px;
    cursor: pointer;
}

/* Body */
.modal-body {
    padding: 20px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.form-group input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 14px;
}

/* Footer */
.modal-footer {
    padding: 15px;
    display: flex;
    justify-content: flex-end;
    background: #f1f1f1;
}

.btn-primary {
    background-color: hsl(176, 88%, 27%);
    color: #fff;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
}

.btn-primary:hover {
    background-color:  hsl(176, 88%, 27%);
}

.btn-secondary {
    background-color: #6c757d;
    color: #fff;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    margin-right: 10px;
    cursor: pointer;
}

.btn-secondary:hover {
    background-color: #5a6268;
}

.tab__body {
    position: relative;
    padding: 15px;
    background: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
}

.delete-button-container {
    position: absolute;
    top: 10px;
    right: 10px;
}

.delete-button-container a {
    color: #ff0000;  /* Red color for delete icon */
    font-size: 18px;
}


</style>
    <!--=============== MAIN ===============-->
    <main class="main">
      <!--=============== BREADCRUMB ===============-->
      <section class="breadcrumb">
        <ul class="breadcrumb__list flex container">
          <li><a href="index.html" class="breadcrumb__link">Home</a></li>
          <li><span class="breadcrumb__link">></span></li>
          <li><span class="breadcrumb__link">Account</span></li>
        </ul>
      </section>

      <!--=============== ACCOUNTS ===============-->
      <section class="accounts section--lg">
        <div class="accounts__container container grid">
          <div class="account__tabs">
            <p class="account__tab {% if active_tab == 'dashboard' %}active-tab{% endif %}" data-target="#dashboard">
              <i class="fi fi-rs-settings-sliders"></i> Dashboard
            </p>
            <p class="account__tab {% if active_tab == 'orders' %}active-tab{% endif %}" data-target="#orders">
              <i class="fi fi-rs-shopping-bag"></i> Orders
            </p>
            <p class="account__tab {% if active_tab == 'address' %}active-tab{% endif %}" data-target="#address">
              <i class="fi fi-rs-marker"></i> My Address
            </p>
            <p class="account__tab {% if active_tab == 'change-password' %}active-tab{% endif %}" data-target="#change-password">
              <i class="fi fi-rs-settings-sliders"></i> Change Password
            </p>
            <p class="account__tab {% if active_tab == 'Wallet' %}active-tab{% endif %}" data-target="#Wallet">
              <i class="fi fi-rs-settings-sliders"></i> Wallet
            </p>
            <p class="account__tab"><i class="fi fi-rs-exit"></i><a style="color: black;" href="{% url 'logout_user' %}">Logout</a></p>
          </div>
          
          <div class="tabs__content {% if active_tab == 'dashboard' %} active-tab {% endif %}" id="dashboard">
            <section class="profile-card">
              <div class="profile-header">
                <div class="profile-icon">
                  <i class="bi bi-person-circle"></i>
                </div>
                <h2>{{ user.first_name|default:user.username }}</h2>
                <p class="subtitle">Member since {{ user.date_joined|date:"F j, Y" }}</p>
              </div>
              <div class="profile-details">
                <ul>
                  <li><strong>Username:</strong> {{ user.username }}</li>
                  <li><strong>Email:</strong> {{ email }}</li>
                  <li><strong>First Name:</strong> {{ user.first_name|default:"Not Provided" }}</li>
                  <li><strong>Last Name:</strong> {{ user.last_name|default:"Not Provided" }}</li>
                  <li><strong>Date Joined:</strong> {{ user.date_joined|date:"F j, Y" }}</li>
                  <li><strong>Referral code:</strong> {{ ref.refferal_code }}</li>
                </ul>
              </div>
            </section>
          </div>
          
          <div class="tabs__content {% if active_tab == 'orders' %} active-tab {% endif %}" id="orders">
            <h3 class="tab__header">Your Orders</h3>
              <div class="tab__body">
                {% if orderdetails %}
                <table class="placed__order-table">
                  <thead>
                    <tr>
                      <th>Order ID</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Total</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for val in orderdetails %}
                    <tr>
                      <td>{{ val.id }}</td>
                      <td>{{ val.created_at }}</td>
                      <td class="status {{ val.status|lower }}">
                        {{ val.status }}
                      </td>
                      <td>₹{{ val.real_price }}</td>
                      <td><a href="{% url 'orderdetails' id=val.id %}" class="btn view__order">View</a></td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
                {% else %}
                <div class="no-orders">
                  <h2>You have no orders</h2>
                </div>
                {% endif %}
              </div>
            </div>
          
            <div class="tabs__content {% if active_tab == 'address' %} active-tab {% endif %}" id="address">
              <h3 class="tab__header">
                Shipping Address
                <!-- Add Address Button (Redirect to Add Address Page) -->
                <a href="{% url 'add_address' %}" class="add-address-btn">Add Address</a>
              </h3>
            
              <div>
                {% if address %}
                  {% for val in address %}
                    <div class="tab__body" id="address-{{ val.id }}">
                      <address class="address">
                        <p><strong>{{ val.fullname }}</strong></p>
                        <p>{{ val.city }}, {{ val.state }} - {{ val.postal_code }}</p>
                        <p>{{ val.landmark }}</p>
                        <p><strong>Phone:</strong> {{ val.phone_number }}</p>
                        <!-- Edit and Delete Buttons -->
                        <a href="{% url 'editaddress' id=val.id %}" class="edit-address-btn">Edit</a>
                       <a href="{% url 'delete_address' id=val.id %}"> <button class="delete-address-btn"    >Delete</button></a>       
                        <!-- onclick="deleteAddress({{ val.id }}) -->
                      </address>
                    </div>
                  {% endfor %}
                {% endif %}
              </div>
            </div>
            
            <div class="tabs__content {% if active_tab == 'change-password' %} active-tab {% endif %}" id="change-password">
              <div class="tab__body">
                <form class="form grid"  method="POST"  action="{% url 'changepassword' %}" >
                  {% csrf_token %}
                  <input
                    type="password"
                    placeholder="Current Password"
                    class="form__input"
                    name = 'currentpassword'
                    required
                  />
                  
                  <input
                    type="password"
                    placeholder="New Password"
                    class="form__input"
                    name="pass1"
                    required
                  />
                  <input
                    type="password"
                    placeholder="Confirm Password"
                    class="form__input"
                    name="pass2"
                    required
                  />
                  {% if passerror %}
                  <p style="color: red;">{{ passerror }}</p>
                  {% endif %}
                  {% if passsuccess %}
                  <p style="color: green;">{{ passsuccess }}</p>
                  {% endif %}
                  <div class="form__btn">
                    <button class="btn btn--md">Save</button>
                  </div>
                </form>
              </div>
            </div>
           
            <div class="tabs__content {% if active_tab == 'Wallet' %} active-tab {% endif %}" id="Wallet">
              <h3 class="tab__header">Wallet</h3>
              <div class="tab__body">
                  <div class="wallet-section" style="margin-top: 20px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                      <h5 style="margin-bottom: 15px; color: #333; font-weight: 600; font-size: 18px;">Wallet Balance</h5>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                          <p style="margin: 0; font-size: 16px; color: #555;">
                              Your current wallet balance is:
                              <strong style="font-size: 18px; color: hsl(176, 88%, 27%)f;">₹{{ wallet.balance }}</strong>
                          </p>
                      </div>
                  </div>
          
                  <!-- Transactions Table -->
               

                      <h5 style="margin-bottom: 15px; color: #333; font-weight: 600; font-size: 18px;">Transaction History</h5>
                      <table style="width: 100%; border-collapse: collapse; background-color: #fff; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); border-radius: 8px; overflow: hidden;">
                          <thead style="background-color:  hsl(176, 88%, 27%); color: #fff;">
                              <tr>
                                  <th style="padding: 10px; text-align: left;">Date</th>
                                  <th style="padding: 10px; text-align: left;">Description</th>
                                  <th style="padding: 10px; text-align: right;">Amount</th>
                                  <th style="padding: 10px; text-align: center;">Type</th>
                              </tr>
                          </thead>
                          <tbody>
                              {% for transaction in trans %}
                                  <tr style="border-bottom: 1px solid #ddd;">
                                      <td style="padding: 10px;">{{ transaction.created_at|date:"d M Y" }}</td>
                                      <td style="padding: 10px;">{{ transaction.status }}</td>
                                      <td style="padding: 10px; text-align: right; color: {% if transaction.status == 'Returned' %}green{% else %}red{% endif %};">
                                          ₹{{ transaction.amount }}
                                      </td>
                                      <td style="padding: 10px; text-align: center; text-transform: capitalize;">
                                          {{ transaction.payment_type }}
                                      </td>
                                  </tr>
                              {% empty %}
                                  <tr>
                                      <td colspan="4" style="padding: 10px; text-align: center; color: #999;">No transactions found.</td>
                                  </tr>
                              {% endfor %}
                          </tbody>
                      </table>
                  </div>
              </div>
          </div>
          


          </div>
        </div>
      </section>

      <!--=============== NEWSLETTER ===============-->
      <section class="newsletter section">
        <div class="newsletter__container container grid">
          <h3 class="newsletter__title flex">
            <img
              src="./assets/img/icon-email.svg"
              alt=""
              class="newsletter__icon"
            />
            Sign in to Newsletter
          </h3>
          <p class="newsletter__description">
            ...and receive $25 coupon for first shopping.
          </p>
          <form action="" class="newsletter__form">
            <input
              type="text"
              placeholder="Enter Your Email"
              class="newsletter__input"
            />
            <button type="submit" class="newsletter__btn">Subscribe</button>
          </form>
        </div>
      </section>
    </main>
    <script>
      // Select all tab buttons and tab content containers
      document.addEventListener('DOMContentLoaded', function () {
  // Select all tabs
  const tabs = document.querySelectorAll('.account__tab');
  // Select all content sections
  const tabContents = document.querySelectorAll('.tabs__content');

  tabs.forEach(tab => {
    tab.addEventListener('click', function () {
      // Remove 'active-tab' class from all tabs and contents
      tabs.forEach(tab => tab.classList.remove('active-tab'));
      tabContents.forEach(content => content.classList.remove('active-tab'));

      // Add 'active-tab' to clicked tab and its corresponding content
      tab.classList.add('active-tab');
      const targetContent = document.querySelector(tab.getAttribute('data-target'));
      targetContent.classList.add('active-tab');
    });
  });
});

    </script>

{% if messages %}
<script>
    {% for message in messages %}
        {% if message.tags == 'error' %}
            Swal.fire({
                icon: 'error',  // Error icon
                title: 'Oops...',
                text: '{{ message }}',
                confirmButtonText: 'OK'
            });
        {% elif message.tags == 'success' %}
            Swal.fire({
                icon: 'success',  // Success icon
                title: 'Success!',
                text: '{{ message }}',
                confirmButtonText: 'OK'
            });
        {% endif %}
    {% endfor %}
</script>
{% endif %}

    <!--=============== FOOTER ===============-->
   {% endblock %}